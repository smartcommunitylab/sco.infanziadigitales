<ion-view id="dettaglidiario" title="{{'diary_details' | translate}}">
    <ion-nav-bar class="bar bar-ungiorno">
        <ion-nav-back-button>
        </ion-nav-back-button>
        <ion-nav-buttons side="right">
            <button class="button button-clear" ng-click="modify()" ng-if="isViewMode()">
                <i class="icon inf_digedit"></i>
            </button>
            <button class="button button-clear" ng-click="save()" ng-if="!isViewMode()">
                <i class="icon inf_digcheck"></i>
            </button>
            </button>
        </ion-nav-buttons>
    </ion-nav-bar>
    <ion-content>
        <div class="list diary-form">
            <div class="item item-divider">{{'data' | translate}}:</div>

            <label class="item item-input" ng-if="!isViewMode()">
                <input type="text" placeholder="{{'name'|translate}}" ng-model="babyCopy.firstName" />
                <i class="ion-asterisk alignRight inline vertical-middle"></i>
            </label>
            <label class="item item-input item-stacked-label" ng-if="isViewMode()">
                <span class="input-label">{{'name'|translate}}</span>
                <span class="textdata">{{babyCopy.firstName}}</span>
            </label>

            <label class="item item-input" ng-if="!isViewMode()">
                <input type="text" placeholder="{{'surname'|translate}}" ng-model="babyCopy.lastName" />
                <i class="ion-asterisk alignRight inline vertical-middle"></i>
            </label>
            <label class="item item-input item-stacked-label" ng-if="isViewMode()">
                <span class="input-label">{{'surname'|translate}}</span>
                <span class="textdata">{{babyCopy.lastName}}</span>
            </label>

            <!-- <label class="item item-input" ng-if="!isViewMode()">
                <input type="date" ng-model="babyCopy.birthday" />
                <i class="ion-asterisk alignRight inline vertical-middle"></i>
            </label> -->
            
            <!--<label class="item item-input item-stacked-label" ng-if="isViewMode()">
              <label class="item item-input"  ng-if="!isViewMode()">
                <input type="date" ng-model="babyCopy.birthday"/>
                <i class="ion-asterisk alignRight inline vertical-middle"></i>
            </label> -->

             <label class="item item-input" ng-click="openDatePickerBaby()" ng-if="!isViewMode(data)">
                <span type="date" class="input-label date">{{babyCopy.birthday | date:'d-MMMM-yyyy'}}</span>
                <i class="ion-asterisk alignRight inline vertical-middle"></i>
                </label>

              <label class="item item-input item-stacked-label"  ng-if="isViewMode()">
                <span class="input-label">{{'date_birth'|translate}}</span>
                <span class="textdata">{{babyCopy.birthday | date:"d MMMM yyyy"}}</span>
            </label>

            <!--
            <label class="item item-input item-select"  ng-if="!isViewMode()">
                <select ng-model="babyCopy.gender">
                    <option>{{ 'male' | translate}}</option>
                    <option>{{ 'female' | translate}}</option>
                </select>
                <i class="ion-asterisk alignRight inline vertical-middle" style="float:right;"></i>
            </label>
-->

            <img ng-src="{{babyCopy.image}}" class="sizeImage" ng-click="changeImage()">

             <div class="item item-divider">{{'data_family' | translate}}:</div>

            <div ng-repeat="data in babyCopy.persons track by $index" ng-if="isFamily(data)">
                <!--                <div class="separator" ng-if="$index > 0"></div>-->
                <label class="item item-input item-stacked-label" ng-if="!isViewMode(data)">
                    <span class="input-label">{{relationType(data)}}:</span>
                    <button class="button button-clear alignRightIcon" ng-click="deleteComponent($index)" ng-if="!readOnly(data) && !noDelete(data)">
                        <i class="icon ion-trash-b"></i>
                    </button>
                </label>
                <label class="item item-input" ng-if="!isViewMode(data)">
                    <input type="text" placeholder="{{'pname'|translate}} {{getPreposition(data)}}" ng-model="data.firstName" />
                    <i class="ion-asterisk alignRight inline vertical-middle"></i>
                </label>
                <label class="item item-input" ng-if="!isViewMode(data)">
                    <input type="text" placeholder="{{'psname'|translate}} {{getPreposition(data)}}" ng-model="data.lastName" />
                    <i class="ion-asterisk alignRight inline vertical-middle"></i>
                </label>
                <!-- <label class="item item-input" ng-if="!isViewMode(data)">
                    <input type="date" ng-model="babyCopy.birthday" />
                 <label class="item item-input"  ng-if="!isViewMode(data)">
                    <input type="date" ng-model="babyCopy.birthday"/>
                    <i class="ion-asterisk alignRight inline vertical-middle"></i> 
                </label>-->

                <label class="item item-input" ng-click="openDatePicker($index)" ng-if="!isViewMode(data)">
                <span type="date" class="input-label date">{{data.birthday | date:'d-MMMM-yyyy'}}</span>
                <i class="ion-asterisk alignRight inline vertical-middle"></i>
                </label>

                <label class="item item-input item-stacked-label" ng-if="isViewMode(data)">
                    <span class="input-label">{{relationType(data)}}:</span>
                    <span class="textdata">{{data.firstName}} {{data.lastName}} ({{data.birthday | date:"d MMMM yyyy"}})</span>
                </label>

            </div>
                
            <label class="item item-input item-select" ng-if="!isViewMode()">
                <div class="input-label">{{ 'add_family_component' | translate}}</div>
                <select ng-model="access.relation">
                    <option value=""></option>
                    <!--<option value="parent">{{ 'parent' | translate}}</option>-->
                    <option value="brother">{{ 'brother' | translate}}</option>
                    <option value="sister">{{ 'sister' | translate}}</option>
                     <option value="grandmother">{{ 'grandmother' | translate}}</option>
                     <option value="grandfather">{{ 'grandfather' | translate}}</option>
                     <option value="uncle">{{ 'uncle' | translate}}</option>
                     <option value="aunt">{{ 'aunt' | translate}}</option>
                </select>
            </label>
            <div ng-if="!!isFamily(access)">
                <label class="item item-input" ng-if="!isViewMode(data, true)">
                    <input type="text" placeholder="{{'pname'|translate}} {{getPreposition(access)}}" ng-model="access.firstName" />
                </label>
                <label class="item item-input" ng-if="!isViewMode(data, true)">
                    <input type="text" placeholder="{{'psname'|translate}} {{getPreposition(access)}}" ng-model="access.lastName" />
                </label>
                <!--<label class="item item-input" ng-if="!isViewMode(data, true)">
                    <input type="text" placeholder="{{'number_parents'|translate}}" ng-model="access.phone" />
                </label>-->
<!--
                <label class="item item-input" ng-if="!isViewMode(data, true)">
                    <input type="text" placeholder="{{'mail_parents'|translate}}" ng-model="access.email" />
                </label>
-->
            </div>

            <div class="item item-divider">{{'acces_diary' | translate}}:</div>

            <div ng-repeat="data in babyCopy.persons track by $index" ng-if="data.authorized">
                <!--                <div class="separator" ng-if="$index > 0"></div>-->
                <label class="item item-input item-stacked-label" ng-if="!isViewMode(data, true)">
                    <span class="input-label">{{relationType(data)}}:</span>
                    <!-- <button class="button button-clear alignRightIcon" ng-click="deleteComponent($index)" ng-if="!readOnly(data, true)">
                        <i class="icon ion-trash-b"></i>
                    </button> -->
                </label>
                <label class="item item-input" ng-if="!isViewMode(data, true)">
                    <input type="text" placeholder="{{'pname'|translate}} {{getPreposition(data)}}" ng-model="data.firstName" />
                    <i class="ion-asterisk alignRight inline vertical-middle"></i>
                </label>
                <label class="item item-input" ng-if="!isViewMode(data, true)">
                    <input type="text" placeholder="{{'psname'|translate}} {{getPreposition(data)}}" ng-model="data.lastName" />
                    <i class="ion-asterisk alignRight inline vertical-middle"></i>
                </label>
               
               
                <div class="item item-input" ng-if="!isViewMode(data, true)" ng-repeat="tel in data.phone track by $index">
                    <i class="form-icon icon inf_digcall "></i>
                    <input type="tel" placeholder="{{'number_parents'|translate}}" ng-model="data.phone[$index]" />
                    <i class="ion-asterisk alignRight inline vertical-middle"></i>
                     <div><i class="alignRight inline vertical-middle ion-minus-circled" ng-click="deletePhone($index,data)"></i></div>
                </div>
                   
                <label class="item item-input add-btn" ng-click="addPhone(data)" ng-if="!isViewMode(data, true) && data.phone.length<2">
                    <i class="form-icon icon ion-plus-circled"></i>
                    <span class="add">Aggiungi numero di telefono</span>
                </label>
                
                <div class="item item-input" ng-if="!isViewMode(data, true)" ng-repeat="mail in data.email track by $index">
                    <i class="form-icon icon ion-android-mail"></i>
                    <input type="email" placeholder="{{'mail_parents'|translate}}" ng-model="data.email" />
                    <i class="ion-asterisk alignRight inline vertical-middle"></i>
                    <div><i class="alignRight inline vertical-middle ion-minus-circled" ng-click="deleteEmail($index,data)"></i>
                </div>
                </div>
                
                <label class="item item-input add-btn" ng-click="addEmail(data)" ng-if="!isViewMode(data, true) && (data.email.length<2 || data.email === null)">
                    <i class="form-icon icon ion-plus-circled"></i>
                    <span class="add">Aggiungi email</span>
                </label>
                

                <label class="item item-input item-stacked-label" ng-if="isViewMode(data, true)">
                    <span class="input-label">{{relationType(data)}}:</span>
                    <span class="textdata">{{data.firstName}} {{data.lastName}}</span>
                </label>
                <div ng-if="isViewMode(data, true)">
                    <a class="item item-contact item-icon-left" href="{{'tel:'+p}}" ng-repeat="p in data.phone track by $index">
                        <i class="icon inf_digcall"></i><span class="textdata">{{p}}</span>
                    </a>
                    <a class="item item-contact item-icon-left" href="{{'mailto:'+p}}" ng-repeat="p in data.email track by $index">
                        <i class="icon ion-android-mail"></i><span class="textdata">{{p}}</span>
                    </a>
                </div>
            </div>
            <!--<label class="item item-input item-select" ng-if="!isViewMode(null, true)">
                <div class="input-label">{{ 'add_authorized' | translate}}</div>
                <select ng-model="access.relation">
                    <option value=""></option>
                    <option value="parent">{{ 'parent' | translate}}</option>
                    <option value="teacher">{{ 'teacher' | translate}}</option>
                </select>
            </label>
            <div ng-if="!!isAccess()">
                <label class="item item-input" ng-if="!isViewMode(data, true)">
                    <input type="text" placeholder="{{'pname'|translate}} {{getPreposition(access.relation)}}" ng-model="access.firstName" />
                </label>
                <label class="item item-input" ng-if="!isViewMode(data, true)">
                    <input type="text" placeholder="{{'psname'|translate}} {{getPreposition(access.relation)}}" ng-model="access.lastName" />
                </label>
                <label class="item item-input" ng-if="!isViewMode(data, true)">
                    <input type="text" placeholder="{{'number_parents'|translate}}" ng-model="access.phone" />
                </label>
                <label class="item item-input" ng-if="!isViewMode(data, true)">
                    <input type="text" placeholder="{{'mail_parents'|translate}}" ng-model="access.email" />
                </label>
            </div>-->


            <div class="item item-divider">{{'notes' | translate}}:</div>
            <label class="item item-input item-stacked-label" ng-if="isViewMode()">
                <span class="textdata" ng-if="isEmptyNote(babyCopy.personalNotes)">{{'nothing_note'| translate}}</span>
                <span class="textdata" ng-if="!isEmptyNote(babyCopy.personalNotes)">{{babyCopy.personalNotes}}</span>
            </label>
            <label class="item item-input" ng-if="!isViewMode()">
                <textarea placeholder="{{'insert_note' | translate}}" ng-model="babyCopy.personalNotes"></textarea>
            </label>
            <div class="item item-divider text-center" ng-if="!isViewMode()"><i class="icon ion-asterisk"></i> {{'asterisk' | translate}}</div>

        </div> 
    </ion-content>
</ion-view>
